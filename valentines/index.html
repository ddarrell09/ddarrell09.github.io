<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>ðŸ’Œ</title>

  <style>
    :root{
      --bg1:#120a1f;
      --bg2:#0b1026;
      --stroke: rgba(255,255,255,.16);
      --glass: rgba(255,255,255,.10);
      --glass2: rgba(255,255,255,.06);
      --text:#f6f2ff;
      --muted: rgba(255,255,255,.72);
      --pink:#ff4d8d;
      --pink2:#ff7aa9;
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --radius: 22px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 20% 20%, #3d104e 0%, transparent 55%),
        radial-gradient(1100px 650px at 90% 30%, #112a6b 0%, transparent 55%),
        linear-gradient(160deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
    }

    /* ===== ALWAYS-ON BACKGROUND LAYERS ===== */
    #bgPolaroids{
      position: fixed;
      inset: 0;
      pointer-events:none;
      z-index: 0;
      overflow:hidden;
      filter: blur(1px);
      opacity: .22;
    }
    .bgPol{
      position:absolute;
      width: 180px;
      aspect-ratio: 4 / 5;
      border-radius: 14px;
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.18);
      box-shadow: 0 20px 60px rgba(0,0,0,.35);
      overflow:hidden;
      transform: rotate(var(--rot)) translate3d(0,0,0);
      animation: drift var(--dur) ease-in-out infinite alternate;
    }
    .bgPol::before{
      content:"";
      position:absolute;
      inset:10px;
      border-radius: 10px;
      background: rgba(255,255,255,.18);
    }
    .bgPol img{
      position:absolute;
      inset:10px;
      width: calc(100% - 20px);
      height: calc(100% - 20px);
      object-fit: cover;
      border-radius: 10px;
      opacity: .9;
    }
    @keyframes drift{
      from{ transform: translate3d(0,0,0) rotate(var(--rot)); }
      to{ transform: translate3d(var(--dx), var(--dy), 0) rotate(calc(var(--rot) + 2deg)); }
    }

    #heartsLayer{
      position: fixed;
      inset: 0;
      pointer-events:none;
      z-index: 1;
      overflow:hidden;
    }
    .heart{
      position:absolute;
      bottom: -40px;
      width: 18px;
      height: 18px;
      transform: rotate(45deg);
      opacity: .55;
      animation: floatUp var(--dur) linear forwards;
      filter: drop-shadow(0 6px 16px rgba(0,0,0,.25));
    }
    .heart::before,
    .heart::after{
      content:"";
      position:absolute;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.55), rgba(255,255,255,0) 55%),
                  linear-gradient(180deg, var(--pink), var(--pink2));
    }
    .heart::before{ left:-9px; top:0; }
    .heart::after{ left:0; top:-9px; }
    .heart{ background: linear-gradient(180deg, var(--pink), var(--pink2)); }

    @keyframes floatUp{
      0%   { transform: translate3d(0,0,0) rotate(45deg) scale(var(--s)); opacity: 0; }
      10%  { opacity: .55; }
      100% { transform: translate3d(var(--x), calc(-100vh - 120px), 0) rotate(45deg) scale(var(--s)); opacity: 0; }
    }

    /* confetti */
    #confetti{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index: 50;
    }

    /* ===== PAGE / TRANSITIONS ===== */
    .page{
      min-height:100vh;
      display:none;
      position: relative;
      z-index: 2; /* above backgrounds */
      padding: 22px 14px;
      opacity: 0;
      transform: translateY(6px);
      transition: opacity .35s ease, transform .35s ease;
    }
    .page.active{
      display:block;
    }
    .page.show{
      opacity: 1;
      transform: translateY(0);
    }

    .wrap{
      max-width: 560px;
      margin: 0 auto;
      padding-bottom: 34px;
    }

    .card{
      background: linear-gradient(180deg, var(--glass), var(--glass2));
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      padding: 16px;
    }

    .title{
      text-align:center;
      font-weight: 850;
      font-size: clamp(26px, 6vw, 34px);
      letter-spacing: .2px;
      margin: 6px 0 14px;
    }
    .sub{
      text-align:center;
      color: var(--muted);
      margin-top: -6px;
      margin-bottom: 14px;
      font-size: 14px;
    }

    /* ===== BUTTONS ===== */
    .btn{
      border:0;
      border-radius: 999px;
      padding: 12px 18px;
      font-weight: 800;
      cursor:pointer;
      transition: transform .12s ease, filter .12s ease;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .btn:active{ transform: scale(.98); filter: brightness(.95); }
    .btnPink{
      background: linear-gradient(180deg, var(--pink), var(--pink2));
      color: #180010;
      box-shadow: 0 10px 22px rgba(255,77,141,.25);
    }
    .btnGhost{
      background: rgba(255,255,255,.10);
      color: var(--text);
      border: 1px solid rgba(255,255,255,.18);
    }

    /* ===== LOCK (YouTube) ===== */
    .lockFrame{
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.25);
      overflow:hidden;
      position:relative;
      aspect-ratio: 16 / 9;
      width:100%;
    }

    .ytShell{
      position:absolute; inset:0;
      display:grid;
      place-items:center;
      background: rgba(0,0,0,.18);
    }

    .ytPlaceholder{
      position:absolute; inset:0;
      display:flex;
      flex-direction:column;
      gap:10px;
      align-items:center;
      justify-content:center;
      padding: 14px;
      background: linear-gradient(180deg, rgba(0,0,0,.10), rgba(0,0,0,.40));
    }

    .ytPlay{
      width: 62px; height: 62px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.25);
      background: rgba(255,255,255,.12);
      display:grid;
      place-items:center;
    }
    .ytPlay svg{ width: 24px; height: 24px; fill: rgba(255,255,255,.9); margin-left: 2px; }

    .lockRow{
      display:flex;
      gap:10px;
      margin-top: 14px;
      align-items:center;
    }
    .input{
      flex:1;
      padding: 14px 14px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.16);
      outline:none;
      background: rgba(0,0,0,.22);
      color: var(--text);
      font-size: 16px;
    }
    .hint{
      margin-top:10px;
      text-align:center;
      font-size: 13px;
      color: rgba(255,255,255,.55);
      min-height: 18px;
    }

    /* ===== QUIZ FULL SCREEN ===== */
    #page-quiz{
      padding: 0;
    }
    .quizFull{
      min-height: 100vh;
      display:flex;
      flex-direction:column;
      justify-content:center;
      padding: 22px 14px 34px;
      gap: 14px;
    }
    .quizTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .pill{
      font-size: 13px;
      padding: 9px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.20);
      color: rgba(255,255,255,.85);
      white-space:nowrap;
    }
    .qText{
      font-size: 22px;
      font-weight: 900;
      line-height: 1.18;
      margin: 6px 0 6px;
    }
    .choices{
      display:flex;
      flex-direction:column;
      gap: 12px;
      margin-top: 6px;
    }
    .choice{
      width: 100%;
      text-align:left;
      padding: 16px 16px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.10);
      color: var(--text);
      font-weight: 850;
      cursor:pointer;
      font-size: 16px;
    }
    .choice.correct{
      border-color: rgba(92,255,170,.55);
      background: rgba(92,255,170,.18);
    }
    .choice.wrong{
      border-color: rgba(255,110,110,.55);
      background: rgba(255,110,110,.12);
    }

    /* ===== VAL PAGE (GIPHY) ===== */
    .center{ text-align:center; }

    .gifWrap{
      width: 100%;
      max-width: 360px;
      margin: 0 auto 14px;
      border-radius: 18px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.15);
    }
    .gifWrap iframe{
      width: 100%;
      height: 420px;
      border:0;
      display:block;
    }

    .rowBtns{
      display:flex;
      gap:10px;
      justify-content:center;
      flex-wrap:wrap;
      margin-top: 12px;
    }
    .blurFlash{
      filter: blur(4px);
      opacity: .85;
      transform: scale(.99);
      transition: filter .25s ease, opacity .25s ease, transform .25s ease;
    }

    /* ===== POLAROIDS STACK VERTICAL ===== */
    .polStack{
      display:flex;
      flex-direction:column;
      gap: 0;
      margin-top: 10px;
    }
    .polItem{
      width: 100%;
      max-width: 460px;
      margin: 0 auto;
      position: relative;
      transform: rotate(var(--rot));
      margin-top: -24px; /* overlap for "stack" look */
    }
    .polCard{
      border-radius: 18px;
      overflow:hidden;
      border: 1px solid rgba(0,0,0,.18);
      box-shadow: 0 18px 48px rgba(0,0,0,.35);
      background: #f5f5f7;
      padding: 12px;
    }
    .polInner{
      background:#fff;
      border-radius: 12px;
      overflow:hidden;
    }
    .polImg{
      width:100%;
      display:block;
      aspect-ratio: 4 / 5;
      object-fit: cover;
      background:#ddd;
    }
    .polCaption{
      padding: 10px 8px 4px;
      color:#111;
      font-weight: 900;
      text-align:center;
      font-size: 14px;
    }
    .tapHint{
      text-align:center;
      font-size: 12px;
      color: rgba(255,255,255,.65);
      margin-top: 8px;
    }
    .noteCard{
      margin-top: 18px;
    }
    .noteCard h2{
      margin: 0 0 10px;
      font-size: 22px;
      text-align:center;
    }
    .noteCard p{
      color: rgba(255,255,255,.88);
      line-height: 1.6;
      font-weight: 650;
      margin: 0;
      white-space: pre-line;
    }

    @media (min-width: 720px){
      .page{ padding: 28px 18px; }
      .gifWrap iframe{ height: 460px; }
    }
  </style>
</head>

<body>
  <!-- always-on backgrounds -->
  <div id="bgPolaroids"></div>
  <div id="heartsLayer"></div>

  <canvas id="confetti"></canvas>

  <!-- ===== PAGE 1: LOCK ===== -->
  <section id="page-lock" class="page active">
    <div class="wrap">
      <div class="card">
        <div class="center" style="margin-bottom:10px;">ðŸ”’</div>

        <div class="lockFrame">
          <!-- YouTube: load only after tap (better for phones) -->
          <div id="ytShell" class="ytShell">
            <div id="ytPlaceholder" class="ytPlaceholder">
              <div class="ytPlay" aria-hidden="true">
                <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
              </div>
              <button id="tapPlay" class="btn btnPink">Tap to play</button>
            </div>
          </div>
        </div>

        <div class="lockRow">
          <input id="pw" class="input" type="password" placeholder="Password" autocomplete="off" />
          <button id="enterBtn" class="btn btnPink" style="padding:12px 16px;">Enter</button>
        </div>

        <!-- NO HINT -->
        <div id="lockMsg" class="hint"></div>
      </div>
    </div>
  </section>

  <!-- ===== PAGE 2: QUIZ ===== -->
  <section id="page-quiz" class="page">
    <div class="quizFull">
      <div class="quizTop">
        <div class="pill" id="qCount">Question 1 / 6</div>
        <div class="pill" id="scorePill">âœ… 0</div>
      </div>

      <div class="qText" id="qText"></div>
      <div class="choices" id="choices"></div>
      <div class="hint" id="quizMsg"></div>
    </div>
  </section>

  <!-- ===== PAGE 3: VALENTINE ===== -->
  <section id="page-val" class="page">
    <div class="wrap">
      <div class="card center">
        <div class="title">Will you be my Valentine? ðŸ’Œ</div>
        <div class="sub">Hey Shella, I made this for you.</div>

        <div class="gifWrap">
          <iframe
            src="https://giphy.com/embed/8QbwUh40Hl96yMgvOx"
            allowfullscreen
            title="Valentine GIF"
          ></iframe>
        </div>

        <div class="rowBtns">
          <button id="yesBtn" class="btn btnPink">Yes ðŸ’–</button>
          <button id="noBtn" class="btn btnGhost">No ðŸ˜­</button>
        </div>
        <div class="hint" id="valMsg"></div>
      </div>
    </div>
  </section>

  <!-- ===== PAGE 4: POLAROIDS + LETTER ===== -->
  <section id="page-pol" class="page">
    <div class="wrap">
      <div class="title" style="margin-bottom:8px;">ðŸ“¸ Us</div>
      <div class="sub">Scroll down ðŸ’—</div>

      <div id="polStack" class="polStack"></div>

      <div class="card noteCard">
        <h2>For you ðŸ’ž</h2>
        <p id="finalLetterText">
Shella, I love you so much.
Iâ€™m really thankful for you.

Iâ€™ve been trying my hardest to keep up and itâ€™s been hard, but youâ€™ve still been right here with me â€” especially when Iâ€™m at my lowest. I love you for that.

This is a hard time for me with everything going on, but you make it feel lighter just by being you.

I canâ€™t wait to live life with you and be happy. ðŸ’˜
        </p>
      </div>
    </div>
  </section>

  <!-- music -->
  <audio id="bgMusic" src="love.mp3" preload="auto" loop></audio>

  <script>
    // ================== SETTINGS ==================
    // Password: grape OR Grape accepted
    const PASSWORDS = new Set(["grape", "Grape"]);

    // YouTube embed (hint video)
    const YT_IFRAME_HTML = `
      <iframe
        width="560" height="315"
        src="https://www.youtube.com/embed/pZ663EJwWPY?si=oE1-oCG5fCIdDEA6"
        title="YouTube video player"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        referrerpolicy="strict-origin-when-cross-origin"
        allowfullscreen
        style="width:100%;height:100%;border:0;"
      ></iframe>
    `;

    // 6 QUESTIONS (random order each time)
    // Love language question: any choice is treated as correct
    const QUESTIONS = [
      {
        q: "What was our first kids name",
        options: ["Tobi", "SJ", "Lando", "Molly"],
        correct: "Tobi",
        mode: "normal"
      },
      {
        q: "What is my love language",
        options: ["Acts of Service", "Quality Time", "Physical Touch", "Words of Affirmation"],
        correct: null,
        mode: "any" // any answer accepted
      },
      {
        q: "What is our favorite snack together",
        options: ["M&Ms", "Puffcorn", "Popcorn", "Gummy Bears"],
        correct: "Puffcorn",
        mode: "normal"
      },
      {
        q: "What is our anniversary",
        options: ["June 30", "June 14", "September 30", "June 29"],
        correct: "June 30",
        mode: "normal"
      },
      {
        q: "Where was our first hike",
        options: ["Mount Rainier", "Wallace Falls", "Rattlesnake", "Marymere Falls"],
        correct: "Mount Rainier",
        mode: "normal"
      },
      {
        q: "What is our favorite show",
        options: ["Community", "Superstore", "Snowfall", "The Office"],
        correct: "Community",
        mode: "normal"
      }
    ];

    // Your real image files (used for BOTH floating background + stacked polaroids)
    const PHOTO_FILES = [
      "17503EC1-5ADC-4A76-B94A-68E07BB33A02.jpeg",
      "9325070F-2DEF-4452-9E9E-52F35D24A94A.jpeg",
      "DEF3A7C1-335A-45B3-8A2F-AB042E139543.jpeg",
      "DSCF0006.jpeg",
      "DSCF0007.jpeg",
      "IMG_0233.jpeg",
      "IMG_0411.jpeg",
      "IMG_0418.jpeg",
      "IMG_0420.jpeg",
      "IMG_4002.jpeg",
      "IMG_4288.jpeg",
      "IMG_5482.jpeg",
      "IMG_6404.jpeg",
      "IMG_9470.jpeg"
    ];

    // Captions you already had
    const CAPTIONS = {
      "DSCF0007.jpeg": "First time we saw each other",
      "DSCF0006.jpeg": "After a good time",
      "IMG_9470.jpeg": "Ocean Shores",
      "17503EC1-5ADC-4A76-B94A-68E07BB33A02.jpeg": "Our first hike",
      "9325070F-2DEF-4452-9E9E-52F35D24A94A.jpeg": "The plushie mission",
      "DEF3A7C1-335A-45B3-8A2F-AB042E139543.jpeg": "Mid hot pot spot",
      "IMG_0233.jpeg": "Scary hike",
      "IMG_0411.jpeg": "Us",
      "IMG_0418.jpeg": "Us",
      "IMG_0420.jpeg": "Us",
      "IMG_4002.jpeg": "Us",
      "IMG_4288.jpeg": "Us",
      "IMG_5482.jpeg": "Us",
      "IMG_6404.jpeg": "Us"
    };

    // ================== HELPERS ==================
    const $ = (id) => document.getElementById(id);

    const showPage = (id) => {
      document.querySelectorAll(".page").forEach(p => {
        p.classList.remove("active");
        p.classList.remove("show");
      });
      const el = $(id);
      el.classList.add("active");
      // allow display then animate in
      requestAnimationFrame(() => el.classList.add("show"));
      window.scrollTo({ top: 0, behavior: "instant" });
    };

    const shuffle = (arr) => {
      const a = arr.slice();
      for (let i=a.length-1; i>0; i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    };

    // ================== YOUTUBE TAP TO PLAY ==================
    const ytShell = $("ytShell");
    const ytPlaceholder = $("ytPlaceholder");
    $("tapPlay").addEventListener("click", () => {
      ytShell.innerHTML = YT_IFRAME_HTML;
    });

    // ================== LOCK -> QUIZ ==================
    $("enterBtn").addEventListener("click", () => {
      const val = ($("pw").value || "").trim();
      if (PASSWORDS.has(val)){
        $("lockMsg").textContent = "";
        startQuiz();
        showPage("page-quiz");
      } else {
        $("lockMsg").textContent = "Nope.";
        $("pw").value = "";
        $("pw").focus();
      }
    });
    $("pw").addEventListener("keydown", (e) => {
      if (e.key === "Enter") $("enterBtn").click();
    });

    // ================== QUIZ ==================
    let quiz = [];
    let qi = 0;
    let score = 0;
    let locked = false;

    function startQuiz(){
      quiz = shuffle(QUESTIONS); // 6 already
      qi = 0;
      score = 0;
      locked = false;
      $("scorePill").textContent = "âœ… 0";
      renderQuestion();
    }

    function renderQuestion(){
      $("quizMsg").textContent = "";
      $("qCount").textContent = `Question ${qi+1} / ${quiz.length}`;
      $("qText").textContent = quiz[qi].q;

      const opts = shuffle(quiz[qi].options);
      const box = $("choices");
      box.innerHTML = "";

      opts.forEach(opt => {
        const b = document.createElement("button");
        b.className = "choice";
        b.textContent = opt;
        b.addEventListener("click", () => handleAnswer(b, opt));
        box.appendChild(b);
      });
    }

    function isCorrect(qObj, opt){
      if (qObj.mode === "any") return true;
      return opt === qObj.correct;
    }

    function handleAnswer(btn, opt){
      if (locked) return;
      locked = true;

      const qObj = quiz[qi];
      const ok = isCorrect(qObj, opt);

      if (ok){
        btn.classList.add("correct");
        score++;
        $("scorePill").textContent = `âœ… ${score}`;
        confettiBurst();

        setTimeout(() => {
          qi++;
          if (qi >= quiz.length){
            showPage("page-val");
          } else {
            locked = false;
            renderQuestion();
          }
        }, 650);
      } else {
        btn.classList.add("wrong");
        $("quizMsg").textContent = "Try again ðŸ™‚";
        setTimeout(() => {
          btn.classList.remove("wrong");
          locked = false;
        }, 600);
      }
    }

    // ================== VALENTINE -> POLAROIDS ==================
    const music = $("bgMusic");
    const valMsg = $("valMsg");

    $("noBtn").addEventListener("click", () => {
      valMsg.textContent = "Wrong button ðŸ˜­ try again";
    });

    $("yesBtn").addEventListener("click", async () => {
      valMsg.textContent = "";

      // blur yes button briefly + confetti + then transition
      const yesBtn = $("yesBtn");
      yesBtn.classList.add("blurFlash");
      confettiBurst();

      // music only after YES (phone-friendly)
      try { await music.play(); } catch(e) {}

      setTimeout(() => {
        yesBtn.classList.remove("blurFlash");
        buildPolaroidStack();
        showPage("page-pol");
      }, 520);
    });

    function buildPolaroidStack(){
      const stack = $("polStack");
      stack.innerHTML = "";

      const files = shuffle(PHOTO_FILES);

      files.forEach((file, idx) => {
        const item = document.createElement("div");
        item.className = "polItem";
        const rot = (Math.random()*8 - 4).toFixed(2) + "deg";
        item.style.setProperty("--rot", rot);

        const cap = CAPTIONS[file] || "ðŸ’—";

        item.innerHTML = `
          <div class="polCard">
            <div class="polInner">
              <img class="polImg" src="${file}" alt="photo" loading="lazy" />
            </div>
            <div class="polCaption">${cap}</div>
          </div>
        `;
        stack.appendChild(item);
      });
    }

    // ================== ALWAYS-ON FLOATING HEARTS ==================
    const heartsLayer = $("heartsLayer");
    function spawnHeart(){
      const h = document.createElement("div");
      h.className = "heart";
      const left = Math.random() * 100;
      const x = (Math.random()*120 - 60).toFixed(0) + "px";
      const s = (0.7 + Math.random()*1.2).toFixed(2);
      const dur = (5.5 + Math.random()*4.8).toFixed(2) + "s";
      h.style.left = left + "vw";
      h.style.setProperty("--x", x);
      h.style.setProperty("--s", s);
      h.style.setProperty("--dur", dur);
      heartsLayer.appendChild(h);
      setTimeout(() => h.remove(), 11000);
    }
    // steady stream (not too heavy)
    setInterval(spawnHeart, 420);
    // seed a few instantly
    for (let i=0;i<10;i++) setTimeout(spawnHeart, i*120);

    // ================== ALWAYS-ON FLOATING BACKGROUND POLAROIDS ==================
    const bg = $("bgPolaroids");
    function buildBgPolaroids(){
      bg.innerHTML = "";
      const picks = shuffle(PHOTO_FILES).slice(0, 10);
      picks.forEach((file, i) => {
        const d = document.createElement("div");
        d.className = "bgPol";
        const top = Math.random()*85;
        const left = Math.random()*85;
        const rot = (Math.random()*16 - 8).toFixed(2) + "deg";
        const dur = (7 + Math.random()*8).toFixed(2) + "s";
        const dx = (Math.random()*80 - 40).toFixed(0) + "px";
        const dy = (Math.random()*70 - 35).toFixed(0) + "px";

        d.style.top = top + "vh";
        d.style.left = left + "vw";
        d.style.setProperty("--rot", rot);
        d.style.setProperty("--dur", dur);
        d.style.setProperty("--dx", dx);
        d.style.setProperty("--dy", dy);

        const img = document.createElement("img");
        img.src = file;
        img.alt = "";
        img.loading = "lazy";
        d.appendChild(img);
        bg.appendChild(d);
      });
    }
    buildBgPolaroids();

    // ================== CONFETTI ==================
    const confettiCanvas = $("confetti");
    const ctx = confettiCanvas.getContext("2d");
    let confettiPieces = [];
    function resizeCanvas(){
      confettiCanvas.width = window.innerWidth;
      confettiCanvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    function confettiBurst(){
      const W = confettiCanvas.width;
      const H = confettiCanvas.height;
      const count = 120;
      const x = W * 0.5;
      const y = H * 0.22;

      for (let i=0; i<count; i++){
        confettiPieces.push({
          x, y,
          vx: (Math.random()*6 - 3),
          vy: (Math.random()*-9 - 3),
          g: 0.18 + Math.random()*0.12,
          s: 4 + Math.random()*5,
          r: Math.random()*Math.PI,
          vr: (Math.random()*0.2 - 0.1),
          life: 70 + Math.random()*40
        });
      }
      if (!animating) animate();
    }

    let animating = false;
    function animate(){
      animating = true;
      ctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);

      confettiPieces.forEach(p => {
        p.x += p.vx;
        p.y += p.vy;
        p.vy += p.g;
        p.r += p.vr;
        p.life -= 1;

        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.r);
        ctx.globalAlpha = Math.max(0, Math.min(1, p.life/110));
        const hue = Math.floor(Math.random()*360);
        ctx.fillStyle = `hsl(${hue} 90% 70%)`;
        ctx.fillRect(-p.s/2, -p.s/2, p.s, p.s);
        ctx.restore();
      });

      confettiPieces = confettiPieces.filter(p => p.life > 0 && p.y < confettiCanvas.height + 40);

      if (confettiPieces.length){
        requestAnimationFrame(animate);
      } else {
        animating = false;
        ctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);
      }
    }

    // initial page fade-in
    requestAnimationFrame(() => document.querySelector(".page.active")?.classList.add("show"));
  </script>
</body>
</html>
