<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>ðŸ’Œ</title>

  <style>
    :root{
      --bg1:#120a1f;
      --bg2:#0b1026;
      --glass: rgba(255,255,255,.08);
      --stroke: rgba(255,255,255,.18);
      --pink:#ff4d8d;
      --pink2:#ff7aa9;
      --text:#f6f2ff;
      --muted: rgba(255,255,255,.72);
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --radius: 22px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 20% 20%, #3d104e 0%, transparent 55%),
        radial-gradient(1100px 650px at 90% 30%, #112a6b 0%, transparent 55%),
        linear-gradient(160deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
    }

    /* ===== ALWAYS-ON FALLING BACKGROUND (hearts + mini polaroids) ===== */
    .bg-fall-layer{
      position:fixed;
      inset:0;
      pointer-events:none;
      overflow:hidden;
      z-index:0;
    }
    .bg-item{
      position:absolute;
      top:-140px;
      left:0;
      will-change: transform, opacity;
      filter: blur(.2px);
      opacity:.55;
      transform: translate3d(0,0,0);
      animation: fall linear forwards;
    }
    @keyframes fall{
      to { transform: translate3d(var(--dx), 120vh, 0) rotate(var(--rot)); opacity: 0; }
    }
    .bg-heart{
      font-size: 22px;
      opacity:.55;
      text-shadow: 0 10px 30px rgba(0,0,0,.35);
      filter: blur(.1px);
    }
    .bg-pol{
      width: 86px;
      background: rgba(255,255,255,.92);
      border-radius: 10px;
      padding: 7px 7px 12px;
      box-shadow: 0 16px 40px rgba(0,0,0,.35);
      opacity:.26;                 /* faded */
      filter: blur(.25px) saturate(.95);
    }
    .bg-pol img{
      width:100%;
      height: 96px;
      object-fit: cover;
      display:block;
      border-radius: 7px;
    }
    .bg-pol .cap{
      margin-top: 6px;
      font-size: 10px;
      color:#111;
      font-weight: 800;
      text-align:center;
      opacity:.85;
    }

    /* ===== APP LAYOUT ===== */
    .app{
      position:relative;
      z-index:1; /* above background */
      min-height:100vh;
    }

    .page{
      min-height:100vh;
      display:none;
      padding: 22px 14px;
    }
    .page.active{ display:block; }

    .wrap{
      max-width: 520px;
      margin: 0 auto;
      padding-bottom: 34px;
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      padding: 16px;
    }

    .title{
      text-align:center;
      font-weight: 900;
      font-size: clamp(26px, 6vw, 34px);
      letter-spacing: .2px;
      margin: 6px 0 14px;
    }
    .sub{
      text-align:center;
      color: var(--muted);
      margin-top: -6px;
      margin-bottom: 14px;
      font-size: 14px;
    }

    .btn{
      border:0;
      border-radius: 999px;
      padding: 12px 18px;
      font-weight: 900;
      cursor:pointer;
      transition: transform .12s ease, filter .12s ease;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .btn:active{ transform: scale(.98); filter: brightness(.95); }

    .btnPink{
      background: linear-gradient(180deg, var(--pink), var(--pink2));
      color: #180010;
      box-shadow: 0 10px 22px rgba(255,77,141,.25);
    }
    .btnGhost{
      background: rgba(255,255,255,.10);
      color: var(--text);
      border: 1px solid rgba(255,255,255,.18);
    }

    .input{
      width:100%;
      padding: 14px 14px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.16);
      outline:none;
      background: rgba(0,0,0,.22);
      color: var(--text);
      font-size: 16px;
    }

    .hint{
      margin-top:10px;
      text-align:center;
      font-size: 13px;
      color: rgba(255,255,255,.55);
      min-height: 18px;
    }

    /* ===== Fade transition between pages ===== */
    .fadeOverlay{
      position:fixed;
      inset:0;
      background: rgba(10,6,18,.92);
      opacity:0;
      pointer-events:none;
      transition: opacity .45s ease;
      z-index: 30;
    }
    .fadeOverlay.show{ opacity:1; pointer-events:auto; }

    /* ===== Password page - YouTube frame ===== */
    .lockFrame{
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.25);
      overflow:hidden;
      position:relative;
      width:100%;
      aspect-ratio: 16 / 9;
    }
    .lockFrame iframe{
      width:100%;
      height:100%;
      border:0;
      display:block;
      background: rgba(0,0,0,.25);
    }
    .ytOverlay{
      position:absolute; inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      flex-direction:column;
      gap:10px;
      background: linear-gradient(180deg, rgba(0,0,0,.18), rgba(0,0,0,.45));
      opacity: 0;
      pointer-events:none;
      transition: opacity .18s ease;
    }
    .ytOverlay.show{ opacity: 1; pointer-events:auto; }
    .ytSmall{
      font-size:12px;
      color:rgba(255,255,255,.72);
      text-align:center;
      padding:0 12px;
    }

    .lockRow{
      display:flex;
      gap:10px;
      margin-top: 14px;
      align-items:center;
    }
    .lockRow .input{ flex:1; }

    /* ===== QUIZ - Full page ===== */
    .quizFull{
      min-height: calc(100vh - 44px);
      display:flex;
      align-items:stretch;
    }
    .quizPanel{
      width:100%;
      display:flex;
      flex-direction:column;
      gap: 14px;
      padding: 18px;
      border-radius: var(--radius);
      border: 1px solid rgba(255,255,255,.18);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }
    .quizTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .pill{
      font-size: 13px;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.18);
      color: rgba(255,255,255,.82);
      white-space:nowrap;
    }
    .qText{
      font-size: clamp(20px, 4.5vw, 26px);
      font-weight: 950;
      margin: 2px 0 2px;
      text-align:left;
      line-height:1.15;
    }
    .choices{
      display:flex;
      flex-direction:column;
      gap:12px;
      margin-top: 6px;
      flex:1;
      justify-content:center;
    }
    .choice{
      text-align:left;
      width:100%;
      padding: 16px 16px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.08);
      color: var(--text);
      font-weight: 900;
      cursor:pointer;
      font-size: 16px;
    }
    .choice.correct{
      border-color: rgba(92,255,170,.55);
      background: rgba(92,255,170,.18);
    }
    .choice.wrong{
      border-color: rgba(255,110,110,.55);
      background: rgba(255,110,110,.12);
    }
    .quizMsg{
      min-height: 18px;
      text-align:center;
      color: rgba(255,255,255,.72);
      font-size: 13px;
      margin-top: -2px;
    }

    /* ===== Valentine page (Giphy) ===== */
    .center{ text-align:center; }
    .rowBtns{
      display:flex;
      gap:10px;
      justify-content:center;
      flex-wrap:wrap;
      margin-top: 12px;
    }
    .giphyWrap{
      width:100%;
      max-width: 320px;
      margin: 0 auto 10px;
      border-radius: 18px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.15);
    }
    .giphyWrap iframe{
      display:block;
      width:100%;
      height: 360px;
      border:0;
    }

    /* ===== Polaroids stacked vertical scroll ===== */
    .polaroidPage{ padding-top: 18px; }
    .stack{
      display:flex;
      flex-direction:column;
      gap: 18px;
      margin-top: 14px;
    }
    .pol{
      position:relative;
      width: 100%;
      max-width: 460px;
      margin: 0 auto;
      background: #f5f5f7;
      border-radius: 18px;
      padding: 12px;
      box-shadow: 0 16px 44px rgba(0,0,0,.38);
      transform: rotate(var(--tilt));
      border: 1px solid rgba(0,0,0,.12);
      overflow:hidden;
    }
    .pol::after{
      content:"";
      position:absolute;
      inset:-1px;
      border-radius: 18px;
      pointer-events:none;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.35);
      opacity:.35;
    }
    .polInner{
      background:#fff;
      border-radius: 12px;
      overflow:hidden;
    }
    .pol img{
      width:100%;
      height: auto;
      aspect-ratio: 4/5;
      object-fit: cover;
      display:block;
      background:#ddd;
    }
    .polCap{
      padding: 10px 8px 4px;
      color:#111;
      font-weight: 950;
      text-align:center;
      font-size: 14px;
    }
    .polNote{
      color: rgba(15,15,20,.78);
      text-align:center;
      font-weight: 700;
      font-size: 12px;
      padding: 0 10px 8px;
      line-height: 1.35;
      white-space: pre-line;
    }

    .finalLetter{
      margin-top: 20px;
    }
    .finalLetter h2{
      margin: 0 0 10px;
      font-size: 22px;
      text-align:center;
      font-weight: 950;
    }
    .finalLetter p{
      color: rgba(255,255,255,.88);
      line-height: 1.6;
      font-weight: 700;
      margin: 0;
      white-space: pre-line;
    }

    /* confetti canvas */
    #confetti{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index: 40;
    }

    @media (min-width: 720px){
      .page{ padding: 28px 18px; }
      .giphyWrap iframe{ height: 420px; }
      .bg-pol{ width: 96px; }
      .bg-pol img{ height: 106px; }
    }
  </style>
</head>

<body>
  <!-- Always-on falling layer -->
  <div class="bg-fall-layer" id="bgLayer"></div>

  <div class="fadeOverlay" id="fadeOverlay"></div>
  <canvas id="confetti"></canvas>

  <div class="app">
    <!-- ===== PAGE 1: LOCK (YouTube hint video) ===== -->
    <section id="page-lock" class="page active">
      <div class="wrap">
        <div class="card">
          <div class="center" style="margin-bottom:10px;">ðŸ”’</div>

          <div class="lockFrame">
            <!-- Your YouTube embed (hint only). iPhone: user taps to play -->
            <iframe
              id="ytFrame"
              src="https://www.youtube.com/embed/pZ663EJwWPY?playsinline=1&rel=0&modestbranding=1"
              title="YouTube video player"
              allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              referrerpolicy="strict-origin-when-cross-origin"
              allowfullscreen>
            </iframe>

            <div id="ytOverlay" class="ytOverlay show">
              <button id="tapPlay" class="btn btnPink">Tap to play</button>
              <div class="ytSmall">(Phone blocks autoplay â€” tap once)</div>
            </div>
          </div>

          <div class="lockRow">
            <input id="pw" class="input" type="password" placeholder="Password" autocomplete="off" />
            <button id="enterBtn" class="btn btnPink" style="padding:12px 16px;">Enter</button>
          </div>

          <!-- no hints -->
          <div id="lockMsg" class="hint"></div>
        </div>
      </div>
    </section>

    <!-- ===== PAGE 2: QUIZ (Full page) ===== -->
    <section id="page-quiz" class="page">
      <div class="wrap quizFull">
        <div class="quizPanel">
          <div class="quizTop">
            <div class="pill" id="qCount">Question 1 / 6</div>
            <div class="pill" id="scorePill">âœ… 0</div>
          </div>

          <div id="qText" class="qText"></div>
          <div id="choices" class="choices"></div>
          <div class="quizMsg" id="quizMsg"></div>
        </div>
      </div>
    </section>

    <!-- ===== PAGE 3: VALENTINE ===== -->
    <section id="page-val" class="page">
      <div class="wrap">
        <div class="card center">
          <div class="title">Will you be my Valentine? ðŸ’Œ</div>
          <div class="sub">Hey Shella, I made this for you.</div>

          <div class="giphyWrap">
            <!-- Your Giphy embed -->
            <iframe
              src="https://giphy.com/embed/8QbwUh40Hl96yMgvOx"
              width="270"
              height="480"
              frameBorder="0"
              class="giphy-embed"
              allowFullScreen>
            </iframe>
          </div>

          <div class="rowBtns">
            <button id="yesBtn" class="btn btnPink">Yes ðŸ’–</button>
            <button id="noBtn" class="btn btnGhost">No ðŸ˜­</button>
          </div>

          <div class="hint" id="valMsg"></div>
        </div>
      </div>
    </section>

    <!-- ===== PAGE 4: POLAROIDS + LETTER ===== -->
    <section id="page-pol" class="page polaroidPage">
      <div class="wrap">
        <div class="title" style="margin-bottom:8px;">ðŸ“¸ Us</div>
        <div class="sub">Scroll down ðŸ’—</div>

        <div id="stack" class="stack"></div>

        <div class="card finalLetter" style="margin-top:18px;">
          <h2>For you ðŸ’ž</h2>
          <p id="finalLetterText">
I love you, Shella. Happy Valentineâ€™s Day. I hope you said yes. I love you so much, and even though weâ€™ve been going through a lot lately, that doesnâ€™t mean weâ€™re going to stop fighting for us. The love I have for you is honestly more than I can even put into words. You mean everything to me, and thatâ€™s why I keep pushing and trying no matter what. Weâ€™ve had our ups and downs, but no relationship is perfect, and I wouldnâ€™t trade what we have for anything. From the first time we met to the last time I saw you, Iâ€™ve always felt the same about loving you. Every date we go on, every little thing we do together, even if it seems small, just doing life with you and keeping you smiling makes my heart feel full. From movie dates on the phone to being together in real life, nobody could ever replace you. I love you so much, Shella, always.
          </p>
        </div>
      </div>
    </section>
  </div>

  <!-- music starts after YES -->
  <audio id="bgMusic" src="love.mp3" preload="auto" loop></audio>

  <script>
    /* ===== SETTINGS ===== */
    const PASSWORD = "grape"; // accept grape or Grape etc (case-insensitive)

    // 6 Questions, random order
    // Love language question: ANY answer is accepted.
    const QUESTIONS = [
      {
        q: "What was our first kids name",
        options: ["Tobi", "SJ", "Lando", "Molly"],
        correct: "Tobi",
        acceptAny: false
      },
      {
        q: "What is my love language",
        options: ["Acts of Service", "Quality Time", "Physicall Touch", "Words of Afformation"],
        correct: null,
        acceptAny: true
      },
      {
        q: "What is our favorite snack together",
        options: ["M&Ms", "Puffcorn", "Popcorn", "Gummy Bears"],
        correct: "Puffcorn",
        acceptAny: false
      },
      {
        q: "What is our anniversary",
        options: ["June 30", "June 14", "September 30", "June 29"],
        correct: "June 30",
        acceptAny: false
      },
      {
        q: "Where was our first hike",
        options: ["Mount rainer", "Wallace Falls", "Rattle snake", "Marymere falls"],
        correct: "Mount rainer",
        acceptAny: false
      },
      {
        q: "What is our favorite show",
        options: ["Community", "Superstore", "Snowfall", "The Office"],
        correct: "Community",
        acceptAny: false
      }
    ];

    // Your local photos in this folder (filenames must match exactly)
    // Captions/notes: keep what you already had vibes-wise (edit text whenever)
    const POLAROIDS = [
      { file:"DSCF0007.jpeg", caption:"First time we saw each other", note:"It started simpleâ€¦ and turned into everything." },
      { file:"DSCF0006.jpeg", caption:"After a good time ðŸ˜", note:"Love, love, love." },
      { file:"IMG_9470.jpeg", caption:"Ocean Shores", note:"Love brushing our teeth together." },
      { file:"17503EC1-5ADC-4A76-B94A-68E07BB33A02.jpeg", caption:"Our first hike", note:"Youâ€™re my favorite hiking partner." },
      { file:"9325070F-2DEF-4452-9E9E-52F35D24A94A.jpeg", caption:"The plushie mission", note:"We hella had the woker for that win ðŸ˜‚" },
      { file:"DEF3A7C1-335A-45B3-8A2F-AB042E139543.jpeg", caption:"Little dates", note:"Even though it was mid asf." },
      { file:"IMG_0233.jpeg", caption:"Scary hike", note:"We dead ass used a sock as a gloveðŸ¤£" },
      { file:"IMG_0411.jpeg", caption:"Us", note:"My favorite place is next to you." },
      { file:"IMG_0418.jpeg", caption:"Random moment", note:"I love our random moments." },
      { file:"IMG_0420.jpeg", caption:"Another day", note:"Still choosing you." },
      { file:"IMG_4002.jpeg", caption:"Smiles", note:"Your smile is literally my weakness." },
      { file:"IMG_4288.jpeg", caption:"First Hike", note:"You make any place feel fun." },
      { file:"IMG_5482.jpeg", caption:"Date night", note:"More of this, forever." },
      { file:"IMG_6404.jpeg", caption:"Comfort", note:"I love doing holiday things with you" }
    ];

    const HEARTS = ["ðŸ’—","ðŸ’–","ðŸ’•","ðŸ’˜","ðŸ’ž","â¤ï¸","ðŸ©·"];

    /* ===== HELPERS ===== */
    const $ = (id) => document.getElementById(id);

    const showPage = (id) => {
      document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
      $(id).classList.add("active");
      window.scrollTo({ top: 0, behavior: "instant" });
    };

    const fadeTo = async (id) => {
      const overlay = $("fadeOverlay");
      overlay.classList.add("show");
      await new Promise(r => setTimeout(r, 320));
      showPage(id);
      await new Promise(r => setTimeout(r, 120));
      overlay.classList.remove("show");
    };

    const shuffle = (arr) => {
      const a = arr.slice();
      for (let i=a.length-1; i>0; i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    };

    /* ===== YouTube tap overlay (simple iPhone-friendly behavior) ===== */
    const ytOverlay = $("ytOverlay");
    $("tapPlay").addEventListener("click", () => {
      // Once tapped, hide overlay. User can press play in the iframe.
      ytOverlay.classList.remove("show");
    });

    /* ===== LOCK -> QUIZ ===== */
    $("enterBtn").addEventListener("click", async () => {
      const val = ($("pw").value || "").trim().toLowerCase();
      if (val === PASSWORD.toLowerCase()){
        $("lockMsg").textContent = "";
        startQuiz();
        await fadeTo("page-quiz");
      } else {
        $("lockMsg").textContent = "Nope.";
        $("pw").value = "";
        $("pw").focus();
      }
    });

    $("pw").addEventListener("keydown", (e) => {
      if (e.key === "Enter") $("enterBtn").click();
    });

    /* ===== QUIZ ===== */
    let quiz = [];
    let qi = 0;
    let score = 0;
    let locked = false;

    function startQuiz(){
      quiz = shuffle(QUESTIONS); // random order
      qi = 0;
      score = 0;
      locked = false;
      $("scorePill").textContent = "âœ… 0";
      renderQuestion();
    }

    function renderQuestion(){
      $("quizMsg").textContent = "";
      $("qCount").textContent = `Question ${qi+1} / ${quiz.length}`;
      $("qText").textContent = quiz[qi].q;

      const opts = shuffle(quiz[qi].options);
      const box = $("choices");
      box.innerHTML = "";

      opts.forEach(opt => {
        const b = document.createElement("button");
        b.className = "choice";
        b.textContent = opt;
        b.addEventListener("click", () => handleAnswer(b, opt));
        box.appendChild(b);
      });
    }

    async function handleAnswer(btn, opt){
      if (locked) return;
      locked = true;

      const q = quiz[qi];
      const isCorrect = q.acceptAny ? true : (opt === q.correct);

      if (isCorrect){
        btn.classList.add("correct");
        score++;
        $("scorePill").textContent = `âœ… ${score}`;
        confettiBurst();

        await new Promise(r => setTimeout(r, 520));
        qi++;

        if (qi >= quiz.length){
          await fadeTo("page-val");
        } else {
          locked = false;
          renderQuestion();
        }
      } else {
        btn.classList.add("wrong");
        $("quizMsg").textContent = "Try again ðŸ™‚";
        await new Promise(r => setTimeout(r, 520));
        btn.classList.remove("wrong");
        locked = false;
      }
    }

    /* ===== VALENTINE ===== */
    const music = $("bgMusic");
    const valMsg = $("valMsg");

    $("noBtn").addEventListener("click", () => {
      valMsg.textContent = "Wrong button ðŸ˜­ try again";
    });

    $("yesBtn").addEventListener("click", async () => {
      valMsg.textContent = "";
      // Blur the Yes button a little after clicking (cute effect)
      $("yesBtn").style.filter = "blur(1px)";
      $("yesBtn").style.opacity = ".9";

      try { await music.play(); } catch(e) {}
      confettiBurst();
      buildPolaroids();
      await fadeTo("page-pol");
    });

    function buildPolaroids(){
      const stack = $("stack");
      stack.innerHTML = "";
      const items = shuffle(POLAROIDS);

      items.forEach((item) => {
        const tilt = (Math.random()*6 - 3).toFixed(2) + "deg";
        const el = document.createElement("div");
        el.className = "pol";
        el.style.setProperty("--tilt", tilt);
        el.innerHTML = `
          <div class="polInner">
            <img src="${item.file}" alt="photo" loading="lazy" />
          </div>
          <div class="polCap">${item.caption}</div>
          <div class="polNote">${item.note || ""}</div>
        `;
        stack.appendChild(el);
      });
    }

    /* ===== CONFETTI ===== */
    const confettiCanvas = $("confetti");
    const ctx = confettiCanvas.getContext("2d");
    let confettiPieces = [];
    let animating = false;

    function resizeCanvas(){
      confettiCanvas.width = window.innerWidth;
      confettiCanvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    function confettiBurst(){
      const W = confettiCanvas.width;
      const H = confettiCanvas.height;
      const count = 120;
      const x = W * 0.5;
      const y = H * 0.25;

      for (let i=0; i<count; i++){
        confettiPieces.push({
          x, y,
          vx: (Math.random()*6 - 3),
          vy: (Math.random()*-9 - 3),
          g: 0.18 + Math.random()*0.12,
          s: 4 + Math.random()*5,
          r: Math.random()*Math.PI,
          vr: (Math.random()*0.2 - 0.1),
          life: 70 + Math.random()*40,
          hue: Math.floor(Math.random()*360)
        });
      }
      if (!animating) animate();
    }

    function animate(){
      animating = true;
      ctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);

      confettiPieces.forEach(p => {
        p.x += p.vx;
        p.y += p.vy;
        p.vy += p.g;
        p.r += p.vr;
        p.life -= 1;

        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.r);
        ctx.globalAlpha = Math.max(0, Math.min(1, p.life/110));
        ctx.fillStyle = `hsl(${p.hue} 90% 70%)`;
        ctx.fillRect(-p.s/2, -p.s/2, p.s, p.s);
        ctx.restore();
      });

      confettiPieces = confettiPieces.filter(p => p.life > 0 && p.y < confettiCanvas.height + 40);

      if (confettiPieces.length){
        requestAnimationFrame(animate);
      } else {
        animating = false;
        ctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);
      }
    }

    /* ===== ALWAYS-ON FALLING BACKGROUND ===== */
    const bgLayer = $("bgLayer");

    function spawnHeart(){
      const el = document.createElement("div");
      el.className = "bg-item bg-heart";
      el.textContent = HEARTS[Math.floor(Math.random()*HEARTS.length)];

      const left = Math.random()*100;
      const dur = 7 + Math.random()*7;            // 7-14s
      const size = 16 + Math.random()*18;         // 16-34px
      const dx = (Math.random()*120 - 60).toFixed(0) + "px";
      const rot = (Math.random()*90 - 45).toFixed(0) + "deg";

      el.style.left = left + "vw";
      el.style.fontSize = size + "px";
      el.style.animationDuration = dur + "s";
      el.style.setProperty("--dx", dx);
      el.style.setProperty("--rot", rot);
      el.style.opacity = (0.25 + Math.random()*0.35).toFixed(2);

      bgLayer.appendChild(el);
      setTimeout(() => el.remove(), dur*1000 + 400);
    }

    function spawnPolaroid(){
      const item = POLAROIDS[Math.floor(Math.random()*POLAROIDS.length)];
      const el = document.createElement("div");
      el.className = "bg-item bg-pol";

      const left = Math.random()*100;
      const dur = 10 + Math.random()*10;          // 10-20s
      const dx = (Math.random()*160 - 80).toFixed(0) + "px";
      const rot = (Math.random()*80 - 40).toFixed(0) + "deg";

      el.style.left = left + "vw";
      el.style.animationDuration = dur + "s";
      el.style.setProperty("--dx", dx);
      el.style.setProperty("--rot", rot);

      el.innerHTML = `
        <img src="${item.file}" alt="" />
        <div class="cap">${item.caption}</div>
      `;

      bgLayer.appendChild(el);
      setTimeout(() => el.remove(), dur*1000 + 400);
    }

    // Start background rain
    setInterval(spawnHeart, 260);        // constant hearts
    setInterval(spawnPolaroid, 1400);    // occasional photo polaroids

    // seed a few right away
    for (let i=0;i<10;i++) setTimeout(spawnHeart, i*120);
    for (let i=0;i<3;i++) setTimeout(spawnPolaroid, 500 + i*700);
  </script>
</body>
</html>
